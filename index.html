<!DOCTYPE html>
<html lang="en">
	<title>Quasar Config Helper</title>

	<meta name="viewport" content="initial-scale=1">
	<link rel="shortcut icon" href="#">
	<style>.info-div {white-space: pre-wrap; word-wrap: break-word; width: 100%; background-color: #eee; border-radius: 3px; font-family: courier, monospace; padding: 0 3px;}</style>
	<script src="static/CXJSBridge.js"></script>

	<body>
		<div style="display: flex">
			<div>Quasar-auto Configs:</div>
			&emsp;
			<button onclick="prompt('', JSON.stringify(QuasarAutoConfig))">Copy</button>
		</div>
		<div id="quasarauto-configs-div" class="info-div">{}</div>
		<br>

		<div style="display: flex">
			<div>Chaoxing Configs:</div>
			&emsp;
			<button onclick="prompt('', JSON.stringify(ChaoxingConfig))">Copy</button>
		</div>
		<div id="chaoxing-configs-div" class="info-div">{}</div>
		<br>

		<div>User Agent:</div>
		<div id="user-agent-div" class="info-div"></div>
		<br>

		<div>Device ID:</div>
		<div id="device-id-div" class="info-div"> </div>
		<br>

		<div>Device Code:</div>
		<div id="device-code-div" class="info-div"> </div>
		<br>

		<div>User Location:</div>
		<div id="user-location-div" class="info-div"> </div>

		<script>
			const ChaoxingConfig = {
				"User-Agent": navigator.userAgent,
			};
            const QuasarAutoConfig = {
                "ChaoxingConfig": ChaoxingConfig
            };

			document.getElementById("user-agent-div").innerText = navigator.userAgent;

			function  _jsBridgeReady(){
				try {
					jsBridge.bind("CLIENT_DEVICE_ID", function(ret) {
						document.getElementById("device-id-div").innerText = JSON.stringify(ret, null, "\t");
						ChaoxingConfig["DeviceId"] = ret.uuid;
						document.getElementById("chaoxing-configs-div").innerText = JSON.stringify(ChaoxingConfig, null, "\t");
						document.getElementById("quasarauto-configs-div").innerText = JSON.stringify(QuasarAutoConfig, null, "\t");
					});
					jsBridge.postNotification("CLIENT_DEVICE_ID", {});
				} catch (err) {}
				
				try {
					jsBridge.bind("CLIENT_DEVICE_FLAG", function(ret) {
						document.getElementById("device-code-div").innerText = JSON.stringify(ret, null, "\t");
						ChaoxingConfig["DeviceCode"] = ret.flagInfo.trim().replace(/[?&]/g, "");
						document.getElementById("chaoxing-configs-div").innerText = JSON.stringify(ChaoxingConfig, null, "\t");
						document.getElementById("quasarauto-configs-div").innerText = JSON.stringify(QuasarAutoConfig, null, "\t");
					});
					jsBridge.postNotification("CLIENT_DEVICE_FLAG", {});
				} catch (err) {}

				try {
					jsBridge.bind("CLIENT_USER_LOCATION", function(ret) {
						document.getElementById("user-location-div").innerText = JSON.stringify(ret, null, "\t");
					});
					jsBridge.postNotification("CLIENT_USER_LOCATION", {});
				} catch (err) {}
			}
		</script>
	</body>
</html>
